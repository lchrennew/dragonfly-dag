# dragonfly-dag

å°èœ»èœ“ ğŸ’— å°è´è¶ï¼ˆ https://github.com/alibaba/butterfly ï¼‰

Dragonfly-dag æ˜¯ä»¥ Butterfly-dag ä¸ºåŸå‹ï¼ŒåŸºäº Vue3 çš„å…¨æ–°å®ç°ã€‚

## Dragonfly-dag çš„ç›®æ ‡ï¼š

- æ›´å¥½çš„å¯ç»´æŠ¤æ€§å’Œä»£ç é€»è¾‘æ¸…æ™°åº¦
- æ›´å¥½çš„ Vue æ•´åˆå¼€å‘ä½“éªŒ

æ„Ÿè°¢å°è´è¶å›¢é˜Ÿå¯¹è¿™ä¸ªé¡¹ç›®çš„æ”¯æŒï¼

## å¿«é€Ÿè¿è¡Œ demoï¼š

å¦‚æœä½¿ç”¨ npmï¼š

```shell script
npm i
npm run dev
```

å¦‚æœä½¿ç”¨ yarnï¼š

```shell script
yarn install
yarn dev
```

## æ ¸å¿ƒç»„ä»¶

### ç”»å¸ƒ `DragonflyCanvas`

#### ç”»å¸ƒå±æ€§

| å±æ€§              | ç±»å‹                               | é»˜è®¤å€¼      | å¿…å¡« | æ”¯æŒåŒå‘ç»‘å®š | è¯´æ˜                                                                                                  |
| ----------------- | ---------------------------------- | ----------- | ---- | ------------ | ----------------------------------------------------------------------------------------------------- |
| nodes             | `Array`                            | `[]`        | N    | Y            | æ˜¾ç¤ºçš„èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹æ•°æ®ç»“æ„å‚è§[æ•°æ®ç±»å‹](#èŠ‚ç‚¹ä¿¡æ¯)                                                     |
| edges             | `Array`                            | `[]`        | N    | Y            | æ˜¾ç¤ºçš„è¾¹ï¼Œè¾¹æ•°æ®ç»“æ„å‚è§[æ•°æ®ç±»å‹](#è¾¹ä¿¡æ¯)                                                           |
| zoomSensitivity   | `Number`                           | `0.001`     | N    | N            | ç¼©æ”¾æ•æ„Ÿåº¦                                                                                            |
| zoomScale         | `Number`                           | `1`         | N    | Y            | ç¼©æ”¾æ¯”ä¾‹                                                                                              |
| maxZoomScale      | `Number`                           | `5`         | N    | N            | æœ€å¤§ç¼©æ”¾æ¯”ä¾‹                                                                                          |
| minZoomScale      | `Number`                           | `0.1`       | N    | N            | æœ€å°ç¼©æ”¾æ¯”ä¾‹                                                                                          |
| layoutConfig      | `Object`                           | `{}`        | N    | N            | å¸ƒå±€é…ç½®ï¼Œè¾¹æ•°æ®ç»“æ„å‚è§[å¸ƒå±€é…ç½®](#Dagreå¸ƒå±€)                                                        |
| showArrow         | `Boolean`                          | `true`      | N    | N            | è¿çº¿æ˜¾ç¤ºç®­å¤´                                                                                          |
| arrowZoomRatio    | `Number`                           | `1`         | N    | N            | ç®­å¤´ç¼©æ”¾æ¯”ä¾‹                                                                                          |
| arrowPosition     | `Number`                           | `100`       | N    | N            | ç®­å¤´æ˜¾ç¤ºç™¾åˆ†æ¯”ä½ç½®ï¼ŒèŒƒå›´`0-100`ï¼Œ`0`ä¸ºèµ·ç‚¹ï¼Œ`100`ä¸ºç»ˆç‚¹                                               |
| beforeAddEdgeHook | `Function`                         | `undefined` | N    | N            | æ·»åŠ è¾¹é¢„å¤„ç†é’©å­                                                                                      |
| nodeGroup         | `String`<br>`Object`<br>`Function` | `undefined` | N    | N            | èŠ‚ç‚¹ç»„æ§é…ç½®ï¼Œç»„æ§é…ç½®æ–¹å¼å‚è§[ç»„æ§é…ç½®](#ç»„æ§é…ç½®)                                                   |
| endpointGroup     | `String`<br>`Object`<br>`Function` | `undefined` | N    | N            | é”šç‚¹ç»„æ§é…ç½®                                                                                          |
| canvasDragging    | `String`                           | `'off'`     | N    | Y            | ç”»å¸ƒæ‹–æ‹½è¡Œä¸ºï¼Œå¯é€‰å€¼ï¼š<br>`off`ï¼šç¦ç”¨<br>`select`ï¼šèŠ‚ç‚¹åœˆé€‰<br>`zoom`ï¼šé€‰åŒºæ”¾å¤§<br>`scroll`ï¼šç”»å¸ƒæ»šå± |
| nodeDragging      | `String`                           | `'off'`     | N    | Y            | èŠ‚ç‚¹æ‹–æ‹½è¡Œä¸ºï¼Œå¯é€‰å€¼ï¼š`off`ï¼šç¦ç”¨<br>`move`ï¼šç§»åŠ¨èŠ‚ç‚¹<br>`link`ï¼šè¿æ¥èŠ‚ç‚¹                             |
| canvasWheeling    | `String`                           | `'off'`     | N    | Y            | ç”»å¸ƒæ»šè½®è¡Œä¸ºï¼Œå¯é€‰å€¼ï¼š`off`ï¼šç¦ç”¨<br>`zoom`ï¼šæ»šè½®ç¼©æ”¾<br>`scroll`ï¼šæ»šå±                               |

#### ç”»å¸ƒæ’æ§½

| æ’æ§½            | scope                                    | é»˜è®¤å†…å®¹     | è¯´æ˜                                                            |
| --------------- | ---------------------------------------- | ------------ | --------------------------------------------------------------- |
| nodeRenderer    | `node`                                   | èŠ‚ç‚¹ ID æ–‡æœ¬ | è‡ªå®šä¹‰èŠ‚ç‚¹æ¸²æŸ“                                                  |
| topEndpoints    | `node`                                   | æ—            | é¡¶éƒ¨é”šç‚¹                                                        |
| leftEndpoints   | `node`                                   | æ—            | å·¦ä¾§é”šç‚¹                                                        |
| rightEndpoints  | `node`                                   | æ—            | å³ä¾§é”šç‚¹                                                        |
| bottomEndpoints | `node`                                   | æ—            | åº•éƒ¨é”šç‚¹                                                        |
| edgeRenderer    | `source`ï¼šèµ·ç‚¹ä¿¡æ¯<br>`target`ï¼šç»ˆç‚¹ä¿¡æ¯ | ç›´çº¿è¿æ¥çº¿   | è‡ªå®šä¹‰è¿æ¥çº¿æ¸²æŸ“ï¼Œè¿çº¿ç«¯ç‚¹æ•°æ®ç»“æ„å‚è§[æ•°æ®ç±»å‹](#è¿çº¿ç«¯ç‚¹ä¿¡æ¯) |

### ç«¯ç‚¹ `DragonflyEndpoint`

WIP

### ç›´çº¿ `StraightLine`

WIP

### ä¹‹å­—çº¿ `ZigZagLine`

WIP

## æ•°æ®ç±»å‹

### èŠ‚ç‚¹ä¿¡æ¯ `Node`

| å­—æ®µ      | ç±»å‹                 | å¿…å¡« | é»˜è®¤å€¼     | è¯´æ˜                                              |
| --------- | -------------------- | ---- | ---------- | ------------------------------------------------- |
| id        | `String`             | Y    | -          | èŠ‚ç‚¹å”¯ä¸€æ ‡è¯† ID                                   |
| label     | `String`             | N    | undefined  | èŠ‚ç‚¹æ˜¾ç¤ºæ ‡ç­¾                                      |
| x         | `Number`             | N    | å¸ƒå±€è®¡ç®—å€¼ | èŠ‚ç‚¹ä¸­å¿ƒ x åæ ‡ï¼Œä¼˜å…ˆäºå¸ƒå±€è®¡ç®—å€¼                 |
| y         | `Number`             | N    | å¸ƒå±€è®¡ç®—å€¼ | èŠ‚ç‚¹ä¸­å¿ƒ y åæ ‡ï¼Œä¼˜å…ˆäºå¸ƒå±€è®¡ç®—å€¼                 |
| movable   | `Boolean`            | N    | true       | èŠ‚ç‚¹æ˜¯å¦å¯ä»¥æ‹–æ‹½ç§»åŠ¨                              |
| linkable  | `Boolean`            | N    | true       | èŠ‚ç‚¹æ˜¯å¦å¯è¿çº¿ï¼ˆæ— è®ºè¿å…¥è¿˜æ˜¯è¿å‡ºï¼‰                |
| endpoints | `Array`              | N    | undefined  | èŠ‚ç‚¹çš„é”šç‚¹åˆ—è¡¨ï¼Œæ•°æ®ç»“æ„å‚è§[æ•°æ®ç±»å‹](#é”šç‚¹ä¿¡æ¯) |
| group     | `String`<br>`Object` | N    | undefined  | èŠ‚ç‚¹ç»„æ§è§„åˆ™                                      |

### é”šç‚¹ä¿¡æ¯ `Endpoint`

| å­—æ®µ        | ç±»å‹                 | å¿…å¡« | é»˜è®¤å€¼    | è¯´æ˜                                                   |
| ----------- | -------------------- | ---- | --------- | ------------------------------------------------------ |
| id          | `String`             | Y    | -         | é”šç‚¹å”¯ä¸€æ ‡è¯† ID                                        |
| label       | `String`             | N    | -         | é”šç‚¹æ˜¾ç¤ºæ ‡ç­¾                                           |
| orientation | `String`             | Y    | -         | é”šç‚¹æ˜¾ç¤ºä½ç½®ï¼Œå¯é€‰å€¼ä¸º`top`ã€`bottom`ã€`left`ã€`right` |
| linkable    | `Boolean`            | N    | true      | é”šç‚¹æ˜¯å¦å¯è¿çº¿ï¼ˆæ— è®ºè¿å…¥è¿˜æ˜¯è¿å‡ºï¼‰                     |
| group       | `String`<br>`Object` | N    | undefined | é”šç‚¹ç»„æ§è§„åˆ™                                           |

### è¾¹ä¿¡æ¯ `Edge`

| å­—æ®µ           | ç±»å‹     | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜          |
| -------------- | -------- | ---- | ------ | ------------- |
| id             | `String` | Y    | -      | è¾¹å”¯ä¸€æ ‡è¯† ID |
| label          | `String` | N    | -      | è¾¹æ˜¾ç¤ºæ ‡ç­¾    |
| source         | `String` | N    | -      | è¾¹èµ·ç‚¹èŠ‚ç‚¹ ID |
| sourceEndpoint | `String` | N    | -      | è¾¹èµ·ç‚¹é”šç‚¹ ID |
| target         | `String` | N    | -      | è¾¹ç»ˆç‚¹é”šç‚¹ ID |
| targetEndpoint | `String` | N    | -      | è¾¹ç»ˆç‚¹é”šç‚¹ ID |

### è¿çº¿ç«¯ç‚¹ä¿¡æ¯ `LineEnd`

| å­—æ®µ   | ç±»å‹     | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜                   |
| ------ | -------- | ---- | ------ | ---------------------- |
| x      | `Number` | N    | -      | èŠ‚ç‚¹/é”šç‚¹çš„ä¸­å¿ƒ x åæ ‡ |
| y      | `Number` | N    | -      | èŠ‚ç‚¹/é”šç‚¹çš„ä¸­å¿ƒ y åæ ‡ |
| width  | `Number` | N    | -      | èŠ‚ç‚¹/é”šç‚¹çš„å®½åº¦        |
| height | `Number` | N    | -      | èŠ‚ç‚¹/é”šç‚¹çš„é«˜åº¦        |

### ç»„æ§ç­–ç•¥ `Group`

ç»„æ§ç­–ç•¥ç”¨äºæ§åˆ¶èŠ‚ç‚¹/é”šç‚¹è¿›è¡Œè¿çº¿æ“ä½œæ—¶çš„è¿å…¥/è¿å‡ºçš„åˆ¤å®šè§„åˆ™ã€‚

#### å­—ç¬¦ä¸²ç»„æ§ç­–ç•¥

ç›´æ¥ç”¨å­—ç¬¦ä¸²åšç»„æ§ç­–ç•¥æ—¶ï¼Œå­—ç¬¦ä¸²ä¸ºç»„åï¼Œç»„åå®Œå…¨ç›¸åŒçš„èŠ‚ç‚¹/é”šç‚¹å¯ä»¥è¿å…¥ã€‚ï¼ˆè¿å‡ºèƒ½å¦æˆåŠŸå–å†³äºç›®æ ‡èŠ‚ç‚¹/é”šç‚¹çš„ç»„ç­–ç•¥ï¼‰

### å¯¹è±¡ç»„æ§ç­–ç•¥

| å­—æ®µ    | ç±»å‹                                           | å¿…å¡« | é»˜è®¤å€¼      | è¯´æ˜                  |
| ------- | ---------------------------------------------- | ---- | ----------- | --------------------- |
| name    | `String`                                       | N    | `undefined` | å½“å‰èŠ‚ç‚¹/é”šç‚¹æ‰€å±ç»„å |
| linkIn  | `String`<br>`Array`<br>`Function`<br>`Boolean` | N    | `undefined` | è¿å…¥è§„åˆ™ï¼Œè§ä¸‹æ–¹      |
| linkOut | `Boolean`                                      | N    | `undefined` | è¿å‡ºè§„åˆ™ï¼Œè§ä¸‹æ–¹ï¼š    |

#### è¿å…¥è§„åˆ™ `linkIn`

| æƒ…å½¢           | é€»è¾‘                                                                                                      |
| -------------- | --------------------------------------------------------------------------------------------------------- |
| `undefined`    | å½“å‰èŠ‚ç‚¹/é”šç‚¹ç»„åä¹Ÿæ˜¯`undefined`æ—¶å…è®¸ä»»ä½•èŠ‚ç‚¹/é”šç‚¹è¿å…¥ï¼Œå¦åˆ™åªå…è®¸å’Œå½“å‰èŠ‚ç‚¹/é”šç‚¹ç»„åä¸€è‡´çš„èŠ‚ç‚¹/é”šç‚¹è¿å…¥ |
| `String`ç±»å‹   | æºèŠ‚ç‚¹/é”šç‚¹å…·æœ‰ç›¸åŒç»„åæ—¶å¯æ¥å…¥                                                                           |
| `Array`ç±»å‹    | æ•°ç»„åŒ…å«æºèŠ‚ç‚¹/é”šç‚¹çš„ç»„åæ—¶å¯è¿å…¥                                                                         |
| `Function`ç±»å‹ | å‡½æ•°è¿”å›`true`å…è®¸è¿å…¥ï¼Œ`false`ä¸å…è®¸è¿å…¥ï¼Œè¾“å…¥å‚æ•°è§ä¸‹æ–¹è¯´æ˜                                             |

#### å‡½æ•°å½¢å¼çš„`linkIn`çš„è¾“å…¥å‚æ•°

```javascript
// è¾“å…¥å‚æ•°ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œè§£æ„å¦‚ä¸‹ï¼š
{
  source, // æºèŠ‚ç‚¹ID
    sourceEndpoint, // æºé”šç‚¹IDï¼Œå¦‚æœå€¼ä¸ºundefinedåˆ™è¡¨ç¤ºæºä¸ºIDä¸ºsourceå€¼çš„èŠ‚ç‚¹ï¼Œå¦åˆ™æºä¸ºå¯¹åº”è¯¥IDçš„é”šç‚¹
    sourceGroup; // æºèŠ‚ç‚¹/é”šç‚¹çš„ç»„å
}
```

#### è¿å‡ºè§„åˆ™ `linkOut`

| æƒ…å½¢           | é€»è¾‘                                                                                                                                                        |
| -------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `undefined`    | å½“å‰èŠ‚ç‚¹å¯ä»¥è¿å‡º                                                                                                                                            |
| `Boolean`ç±»å‹  | ä¸º`true`æ—¶å¯ä»¥è¿å‡ºï¼Œ`false`ä¸å…è®¸è¿å‡º                                                                                                                       |
| `Function`ç±»å‹ | å‡½æ•°å…¥å‚ä¸ºå½“å‰èŠ‚ç‚¹ä¿¡æ¯ï¼ˆæˆ–é”šç‚¹æ‰€åœ¨èŠ‚ç‚¹ï¼‰å’Œé”šç‚¹ä¿¡æ¯ï¼ˆå¦‚æœæºä¸ºèŠ‚ç‚¹ï¼Œé”šç‚¹ä¿¡æ¯åˆ™ä¸º`undefined`ï¼‰ï¼Œå‡½æ•°è¿”å›`Boolean`ç±»å‹çš„å€¼ä¸º`true`æ—¶å…è®¸è¿å‡ºï¼Œ`false`ä¸å…è®¸è¿å‡º |
